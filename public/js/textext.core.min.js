/*
 Copyright (C) 2011 Alex Gorbatchev. All rights reserved.
 @license MIT License
*/
(function(e,k){function l(){}function h(){}function p(){}function m(a,c){"string"===typeof c&&(c=c.split("."));var d=c.join(".").replace(/\.(\w)/g,function(a,c){return c.toUpperCase()}),b=c.shift(),f;typeof(f=a[d])==n&&typeof(f=a[b])!=n&&0<c.length&&(f=m(f,c));return f}function q(){function a(a,c){b.bind(a,function(){return c.apply(d,arguments)})}var c=r.apply(arguments),d=this,b=1===c.length?d:c.shift(),f,c=c[0]||{};for(f in c)a(f,c[f])}function s(a,c){return{input:a,form:c}}var t=(JSON||{}).stringify,
r=Array.prototype.slice,b,n="undefined",v={itemManager:h,plugins:[],ext:{},html:{wrap:'<div class="text-core"><div class="text-wrap"/></div>',hidden:'<input type="hidden" />'},keys:{8:"backspace",9:"tab",13:"enter!",27:"escape!",37:"left",38:"up!",39:"right",40:"down!",46:"delete",108:"numpadEnter"}};if(!t)throw Error("JSON.stringify() not found");b=h.prototype;b.init=function(a){};b.filter=function(a,c){var d=[],b,f;for(b=0;b<a.length;b++)f=a[b],this.itemContains(f,c)&&d.push(f);return d};b.itemContains=
function(a,c){return 0==this.itemToString(a).toLowerCase().indexOf(c.toLowerCase())};b.stringToItem=function(a){return a};b.itemToString=function(a){return a};b.compareItems=function(a,c){return a==c};b=l.prototype;b.init=function(a,c){var d=this,b,f,g;d._defaults=e.extend({},v);d._opts=c||{};d._plugins={};d._itemManager=f=new (d.opts("item.manager"));a=e(a);g=e(d.opts("html.wrap"));b=e(d.opts("html.hidden"));a.wrap(g).keydown(function(a){return d.onKeyDown(a)}).keyup(function(a){return d.onKeyUp(a)}).data("textext",
d);e(d).data({hiddenInput:b,wrapElement:a.parents(".text-wrap").first(),input:a});b.attr("name",a.attr("name"));a.attr("name",null);b.insertAfter(a);e.extend(!0,f,d.opts("ext.item.manager"));e.extend(!0,d,d.opts("ext.*"),d.opts("ext.core"));d.originalWidth=a.outerWidth();d.invalidateBounds();f.init(d);d.initPatches();d.initPlugins(d.opts("plugins"),e.fn.textext.plugins);d.on({setFormData:d.onSetFormData,getFormData:d.onGetFormData,setInputData:d.onSetInputData,anyKeyUp:d.onAnyKeyUp});d.trigger("postInit");
d.trigger("ready");d.getFormData(0)};b.initPatches=function(){var a=[],c=e.fn.textext.patches,d;for(d in c)a.push(d);this.initPlugins(a,c)};b.initPlugins=function(a,c){var d,b,f=[],g;"string"==typeof a&&(a=a.split(/\s*,\s*|\s+/g));for(g=0;g<a.length;g++)if(d=a[g],b=c[d])this._plugins[d]=b=new b,this[d]=function(a){return function(){return a}}(b),f.push(b),e.extend(!0,b,this.opts("ext.*"),this.opts("ext."+d));f.sort(function(a,c){a=a.initPriority();c=c.initPriority();return a===c?0:a<c?1:-1});for(g=
0;g<f.length;g++)f[g].init(this)};b.hasPlugin=function(a){return!!this._plugins[a]};b.on=q;b.bind=function(a,c){this.input().bind(a,c)};b.trigger=function(){var a=arguments;this.input().trigger(a[0],r.call(a,1))};b.itemManager=function(){return this._itemManager};b.input=function(){return e(this).data("input")};b.opts=function(a){var c=m(this._opts,a);return"undefined"==typeof c?m(this._defaults,a):c};b.wrapElement=function(){return e(this).data("wrapElement")};b.invalidateBounds=function(){var a=
this.input(),c=this.wrapElement(),d=c.parent(),b=this.originalWidth+"px",f;this.trigger("preInvalidate");f=a.outerHeight()+"px";a.css({width:b});c.css({width:b,height:f});d.css({height:f});this.trigger("postInvalidate")};b.focusInput=function(){this.input()[0].focus()};b.serializeData=t;b.hiddenInput=function(a){return e(this).data("hiddenInput")};b.getWeightedEventResponse=function(a,c){var b={},e=0;this.trigger(a,b,c);for(var f in b)e=Math.max(e,f);return b[e]};b.getFormData=function(a){a=this.getWeightedEventResponse("getFormData",
a||0);this.trigger("setFormData",a.form);this.trigger("setInputData",a.input)};b.onAnyKeyUp=function(a,c){this.getFormData(c)};b.onSetInputData=function(a,c){this.input().val(c)};b.onSetFormData=function(a,c){this.hiddenInput().val(this.serializeData(c))};b.onGetFormData=function(a,c){var b=this.input().val();c[0]=s(b,b)};e(["Down","Up"]).each(function(){var a=this.toString();b["onKey"+a]=function(c){var b=this.opts("keys")[c.keyCode],e=!0;b&&(e="!"!=b.substr(-1),b=b.replace("!",""),this.trigger(b+
"Key"+a),"Up"==a&&this._lastKeyDown==c.keyCode&&(this._lastKeyDown=null,this.trigger(b+"KeyPress")),"Down"==a&&(this._lastKeyDown=c.keyCode));this.trigger("anyKey"+a,c.keyCode);return e}});b=p.prototype;b.on=q;b.formDataObject=s;b.init=function(a){throw Error("Not implemented");};b.baseInit=function(a,b){a._defaults=e.extend(!0,a._defaults,b);this._core=a;this._timers={}};b.startTimer=function(a,b,d){var e=this;e.stopTimer(a);e._timers[a]=setTimeout(function(){delete e._timers[a];d.apply(e)},1E3*
b)};b.stopTimer=function(a){clearTimeout(this._timers[a])};b.core=function(){return this._core};b.opts=function(a){return this.core().opts(a)};b.itemManager=function(){return this.core().itemManager()};b.input=function(){return this.core().input()};b.val=function(a){var b=this.input();if(typeof a===n)return b.val();b.val(a)};b.trigger=function(){var a=this.core();a.trigger.apply(a,arguments)};b.bind=function(a,b){this.core().bind(a,b)};b.initPriority=function(){return 0};var u=!1,g=e.fn.textext=function(a){var b;
u||null==(b=e.fn.textext.css)||(e("head").append("<style>"+b+"</style>"),u=!0);return this.map(function(){var b=e(this);if(null==a)return b.data("textext");var c=new l;c.init(b,a);b.data("textext",c);return c.input()[0]})};g.addPlugin=function(a,b){g.plugins[a]=b;b.prototype=new g.TextExtPlugin};g.addPatch=function(a,b){g.patches[a]=b;b.prototype=new g.TextExtPlugin};g.TextExt=l;g.TextExtPlugin=p;g.ItemManager=h;g.plugins={};g.patches={}})(jQuery);
(function(e){function k(){}e.fn.textext.TextExtIE9Patches=k;e.fn.textext.addPatch("ie9",k);e=k.prototype;e.init=function(e){if(-1!=navigator.userAgent.indexOf("MSIE 9"))e.on({postInvalidate:this.onPostInvalidate})};e.onPostInvalidate=function(){var e=this.input(),h=e.val();e.val(Math.random());e.val(h)}})(jQuery);